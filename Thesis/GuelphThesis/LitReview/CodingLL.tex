\section{Coding Latter Lotteries}
\subsection{Overview}
In this paper, the authors provide three methods to encode ladder-lotteries as 
binary strings. Coding discrete objects as binary strings is an appealing theme because 
it allows for compact represntation of them for a computer.
\subsection{Route Based Encoding}
The first method is termed \emph{route based encoding method} in 
which each route of an element in the permutation has a binary encoding. Let $L_{k}$
be a ladder lottery for some arbitrary permutation $\pi=(p_{1},\dots,p_{N})$. The route 
of element $p_{i}$ is encoded by keeping in mind $p_{i}$ crosses bars in its route 
going left zero or more times and crosses bars in its route going right zero or 
more times. The maximum number of bars $p_{i}$ can have is $N-1$, therefore the 
upper bound for the number of left/right crossings for $p_{i}$ is $N-1$. 
Let a left crossing be denoted with a $'0'$ and let a right crossing be denoted 
with a $'1'$. Let $C_{pi}$ be the route encoding for the $i^{th}$ element 
in $\pi$. To construct $C_{pi}$,  append $0$ and $1$ to each other representing 
the left and right crossings of $p_{i}$ from the top left 
to bottom right of the ladder. If the number of crossings for $p_{i}$ 
is less than $N-1$, append $0s$ to the encoding of the route of $p_{i}$ until
the encoding is of length $N-1$. Let $LC_{L}$ be the route encoding for 
some arbitrary ladder in $OptL\{\pi\}$ is $C_{p_{1}}, C_{p_{2}, \dots C_{p_{N}}}$.
For an example of the route encoding for the root ladder of $(3,2,5,4,1)$ refer to 
Fig. 2.5. In Fig 2.5 you will see that $C_{p_{1}}$ is 11\underline{00}. Underlined 
$0s$ are the $0s$ added to ensure the length of $C_{p_{1}}$ is $N-1$.
Since the length of $C_{pi}$ is $N-1$ and the number of elements in $\pi$ is $N$
then the length of $LC_{L}=N(N-1)$. Hence the number of bits needed for $LC_{L}$ 
belongs to $\mathcal{O}(n^{2})$.\par 
\begin{figure}[!htp]
    \begin{center}
        \begin{tikzpicture}
    
            %%draw the lines
            \draw(0, 0) to (0, 4);
                \node at(0, 4.3){3};
                \node at(0, -0.3){1};
            \draw(2, 0) to (2, 4);
                \node at (2, 4.3){2};
                \node at(2, -0.3){2};
            \draw(4, 0) to (4, 4);
                \node at (4, 4.3){5};
                \node at (4, -0.3){3};
            \draw(6, 0) to (6, 4);
                \node at (6, 4.3){4};
                \node at (6, -0.3){4};
            \draw(8, 0) to (8, 4);
                \node at (8, 4.3){1};
                \node at (8, -0.3){5};
    
            %%Draw the bars
            \draw(0, 2) to (2, 2);
            \draw(2, 1.5) to (4,1.5);
            \draw(0, 1) to (2, 1);

            \draw(4, 3) to (6, 3);
            \draw(6, 2.5) to (8, 2.5);
            \draw(4, 2) to (6, 2);
        \end{tikzpicture}
    \end{center}
   
  \caption{The route encoding for the following ladder lottery is 11\underline{00}01\underline{00}11\underline{00}01\underline{00}0000}

\end{figure}

\subsection{Line Based Encoding}
The second method is termed \emph{line based encoding} which focuses 
on encoding the lines of the ladder-lottery. Each line is represented 
as a sequence of endpoints of bars. Let $L$ be an optimal ladder-lottery 
with $N$ lines and $B$ bars, then for some arbitrary line $i$ there 
are zero or more right/left endpoints of bars that 
come into contact with line $i$. Let $1$ denote a left end point that 
comes into contact with line $i$ and let $0$ denote a right 
end point that comes into contact with line $i$. Finally, append a $0$
to line $i$ to denote the end of the line. Then line $i$ can be 
encoded, from top to bottom, as a sequence of $1s$ and $0s$ that 
terminates in a $0$. Let $lc_{i}$ be 
the line encoding for line $i$. Given the ladder in Fig. 2.5, 
$lc_{3}$ is $001\underline{0}$. The \underline{0} denotes 
the end of the line. Let $LC_{L}$ be the line encoding for 
some arbitrary ladder, then $LC_{L}=lc_{1}, lc_{2}, \dots lc_{n}$.
Let $L_{2.5}$ refer to the ladder in Fig. 2.5, then 
$LC_{L_{2.5}}=11\underline{0}010\underline{0}110\underline{0}010\underline{0}0\underline{0}$\par 
In order to reconstruct $L_{k}$ from $LC_{L_{k}}$, or in other words decode
$LC_{L_{k}}$ it is important to recognize that the first line only has left endpoints attached to it. Since left 
end points are encoded as a $1$ then it is guarenteed that the first $0$ 
represents the end of line $1$. Secondly, the last/$Nth$ bar 
has only right end points attached to it.  Therefore $lc_{n}$ will only have $0s$. Therefore, $lc_{n}$
does not require a terminating $0$. Thirdly, for any 
line $i+1$, if line $i+1$ has a $0$ then there must be a corresponding $1$
in line $i$. That is to say, if the right end point of a bar is on line 
$i+1$ then that same bar must have a left endpoint on line $i$. To decode 
$LC_{L}$ start by decoding line $1$. The line will contain $0$ or more 
left end points. To decode $lc_{i+1}$ where $i+1>1$, go to 
$lc_{i}$ and match each $1$ in $lc_{i}$ with a $0$ in $lc_{i+1}$. 
Let $k=$ the number of $1s$ in $lc_{i}$. Let $j=$ the number 
of $0s$ in $lc_{i+1}$ then $k=j-1$; due to the last $0$ in $lc_{i+1}$ denoting 
the end of line $i+1$.  Intuitively, this means match every left end point 
of a bar in line $i$ with a right end point in line $i+1$. The last $0$
represents the end of line $i+1$. For the $1s$ in $lc_{i+1}$ draw a left 
end point on line $i+1$ relative to where the $1$ occured to its left and 
right neigbor in $lc_{i+1}$. For an example of a full decoding of $LC_{L_{(4,2,3,1)}}$
please refer to Fig. 2.6.\pagebreak
\begin{figure}[!htp]
    \begin{center}
        \begin{tikzpicture}
            \draw(0, 0) to (0, 4);
            \node at (0, 4.3){4};
            \node at (0, -0.3){1};
        \draw(2, 0) to (2, 4);
            \node at (2, 4.3){2};
            \node at (2, -0.3){2};
        \draw(4, 0) to (4, 4);
            \node at (4, 4.3){3};
            \node at (4, -0.3){3};
        \draw(6, 0) to (6, 4);
            \node at (6, 4.3){1};
            \node at (6, -0.3){4};

        %%bars 
        \draw(0, 3) to (0.7, 3);
            \node at (0.35, 3.3){1};
        \draw (1.3, 3) to (2, 3);
            \node at (1.65, 3.3){0};

        \draw(2, 2.5) to (2.7, 2.5);
            \node at (2.35, 2.8){1};
        \draw(3.3, 2.5) to (4, 2.5);
            \node at (3.65, 2.8){0};

        \draw(4, 2) to (4.7, 2);
            \node at (4.35, 2.3){1};
        \draw(5.3, 2) to (6, 2);
            \node at (5.65, 2.3){0};

      

        \draw(2, 1) to (2.7, 1);
            \node at (2.35, 1.3){1};
        \draw(3.3, 1) to (4, 1);
            \node at (3.65, 1.3){0};

        \draw(0, 0.5) to (0.7, 0.5);
            \node at (0.35, 0.8){1};
        \draw(1.3, 0.5) to (2, 0.5);
            \node at (1.65, 0.8){0};

        \end{tikzpicture}
      

    \end{center}
    \caption{$LC_{L_{(4,2,3,1)}}=lc_{1}=11\underline{0},lc_{2}=0110\underline{0},lc_{3}=010\underline{0},lc_{4}=0$}
\end{figure}

Since each bar is encoded as two bits, and there are $N-1$ bits as terminating bits; 
one for each line in $L$, then the number of bits required is $N + 2B -1$, where $N$
is the number of lines and $B$ is the number of bars. Encoding and decoding can be 
done in $\mathcal{O}(n+b)$ time. Clearly the line-based encoding 
trumps the route-based encoding in both time and space complexity.

\subsection{Improved Line-Based Encoding}
Although the line-based encoding is better than the route based 
encoding, it can still be further optimized. The authors provide 
three improvements to the line-based encoding. These three improvements
can be combined to really help imrpove the line based encoding's 
space efficiency. 
\subsubsection{Imrpovement 1}
Since the $Nth$ line has only right endpoints attached to it, 
then it actually does not need to be encoded. Right endpoints 
are denoted as $0$ and left endpoints are encoded as $1$, therefore the number of right endpoints 
for line $N$ is equal to the number of $1s$ in $lc_{n-1}$.
Thus, there is no need for $lc_{n}$. The encoding with improvment 
one for the ladder in Fig. 2.6 is $11\underline{0}0110\underline{0}010$.
\subsubsection{Improvement 2}
Improvement Two is based off of the fact that given any two bars,
$x,y$ let $l_{x}$ denote the left endpoint of bar $x$, let 
$l_{y}$ denote the left endoint of bar $y$, let $r_{x}$ denote 
the right end point of bar $x$ and let $r_{y}$ denote the right 
end point of bar $y$. Let line $i$ be the line of $l_{x}$ and $l_{y}$
and let line $i+1$ be the line of $r_{x}$ and $r_{y}$.
\begin{theorem}
There are three possible cases for the 
placement of $x$ and $y$ in some 
arbitrary ladder from $OptL\{\pi\}$. The first case is that there 
is at least one other bar, $z$, with a right end point, $r_{z}$ between $l_{x}$
and $l_{y}$ on line $i$. The second case is that there is at least one other bar 
$z$, with a left end point, $l_{z}$, between $r_{x}$ and $r_{y}$ on line $i+1$. 
The third case is that there is at least one bar, $z$, with a right end point, 
$r_{z}$, betwen $l_{x}$ and $l_{y}$ on line $i$ and there is at least one other bar, 
$z\prime$ with a left end point, $l_{z\prime}$, between $r_{x}$ and $r_{y}$ on line $i+1$. 
For an example of all three cases refer to Fig 2.7.\par
\end{theorem}

%%figure demonstrating the three cases for bar positions
\begin{figure}[!htp]
       
            %%first case
            \begin{minipage}{.3\textwidth}
                \begin{flushleft}
                \begin{tikzpicture}
                    \draw(0, 0) to (0, 4);
                        \node at (0, 4.3){$i$};
                    \draw(1.5, 0) to (1.5, 4);
                        \node at (1.5, 4.3){$i+1$};
                    \draw(-1.5, 0) to (-1.5, 4);
                        \node at (-1.5, 4.3){$i-1$};
                    \draw(-1.5, 2) to (0, 2);
                        \node at (-0.5, 2.3){$r_{z}$};
                    \draw(0, 3) to (1.5, 3);
                        \node at (0.5, 3.3){$l_{x}$};
                    \draw(0, 1) to (1.5, 1);
                        \node at (0.5, 1.3){$l_{y}$};
                \end{tikzpicture}
            \end{flushleft}

            \end{minipage}
             \begin{minipage}{.3\textwidth}
                \begin{center}

                \begin{tikzpicture}
                
                 \draw(0, 0) to (0, 4);
                    \node at (0, 4.3){$i$};
                 \draw(1.5, 0) to (1.5, 4);
                    \node at (1.5, 4.3){$i+1$};
                 \draw(-1.5, 0) to (-1.5, 4);
                    \node at (-1.5, 4.3){$i-1$};
                    \draw(-1.5, 3) to (0, 3);
                        \node at (-0.5, 3.3){$r_{x}$};
                    \draw(0, 2) to (1.5, 2);
                        \node at (0.5, 2.3){$l_{z}$};
                    \draw(-1.5, 1) to (0, 1);
                        \node at (-0.5, 1.3){$r_{y}$};
                
                   
                
                \end{tikzpicture}
                \end{center}
            \end{minipage}
             \begin{minipage}{.3\textwidth}
                \begin{center}

                \begin{tikzpicture}
                
                 \draw(0, 0) to (0, 4);
                    \node at (0, 4.3){$i$};
                 \draw(1.5, 0) to (1.5, 4);
                    \node at (1.5, 4.3){$i+1$};
                 \draw(-1.5, 0) to (-1.5, 4);
                    \node at (-1.5, 4.3){$i-1$};
                 \draw(3, 0) to (3, 4);
                    \node at (3, 4.3){$i+2$};
                    \draw(0, 3) to (1.5, 3);
                        \node at (0.3, 3.3){$l_{x}$};
                        \node at (1.2, 3.3){$r_{x}$};
                     \draw(-1.5, 2) to (0, 2);
                        \node at (-0.5, 2.3){$r_{z}$};
                    \draw(0, 1) to (1.5, 1);
                        \node at (0.3, 1.3){$l_{y}$};
                         \node at (1.2, 1.3){$r_{y}$};
                     \draw(1.5, 2) to (3, 2);
                        \node at (1.8, 2.3){$l_{z\prime}$};
                
                   
                
                \end{tikzpicture}
                \end{center}
            \end{minipage}
        

    \caption{Three examples of the three cases for the placement 
    of bars $x$ and $y$ in a ladder-lottery}
\end{figure}
\begin{proof}
    Suppose that none of the above cases hold. Let $L_{\pi}$ be an 
    optimal ladder-lottery with bars $x$ and 
    bar $y$. If none of the cases hold then $x$ and $y$ are directly above/below each other without 
    the enpoint of some third bar $z$ between $l_{x}$ and $l_{y}$ or between $r_{x}$ and $r_{y}$.
    Let $x$ be the bar for the inversion of two elements $p$ and $q$ in $\pi$. 
    As $p$ and $q$ travel through the ladder they will cross each other at bar $x$; 
    thus uninverting them. Since bar $y$ is directly below bar $x$, then $p$ and $q$ will cross 
    bar $y$ thus re-inverting them. Therefore, there will need to be a third 
    bar that uninverts $p$ and $q$ a second time. Since this third bar is 
    redundant, $L_{\pi}$ is non-optimal which is a contradiction. Let $x$ be a bar for two 
    elements in $\pi$, $p$ and $q$ such that $p$ and $q$ do not form an inversion. Then $x$ 
    will invert $p$ and $q$ and $y$ will uninvert them. Thus making both $x$ and $y$ redundant
    bars which is also a contradiction. Therefore one of the above cases must hold.
\end{proof}
Knowing that one of the three above cases must hold is beneficial for improving the 
line-based encoding. If $l_{x}$ and $l_{y}$ on line $i$ have no $r_{z}$ between them, 
then there must be at least one $l_{z\prime}$ between $r_{x}$ and $r_{y}$ on line $i+1$.
Since a left endpoint is encoded as a $1$ and a right endpoint is encoded as a $0$, 
a $1$ can be omitted for the encoding of line $i+1$ if $l_{x}$ and $l_{y}$ have no $r_{z}$
between them on line $i$. That is to say, if there is not a $0$ between 
the two  $1s$ for $l_{x}$, $l_{y}$ in $lc_{i}$, it is implied that there is at least one $1$ between 
the two $0s$ for $r_{x}$, $r_{y}$ on $lc_{i+1}$. Hence, one of the $1s$ in $lc_{i+1}$ can be omitted. 
The line encoding with improvement two for the ladder in Fig 2.6 is $11\underline{0}010\underline{0}00\underline{0}0$.
\subsubsection{Imrpovement 3}
Improvement three is based off of saving some bits for right 
end points/$0s$ in $lc_{n-1}$. Since line $n$ has no left end points,
then then there must be some right endpoints between any two 
consecutive bars connecting lines $n-1$ and line $n$. If you 
refer to Fig. 2.7, then the only configuration for lines $n-2, n-1, n$
is the middle configuration. Knowing this, then 
given two bars, $x$ and $y$ with $l_{x}$/$l_{y}$ on line 
$n-1$ and $r_{x}$/$r_{y}$ on line $n$, there must be at least 
one bar, $z$, with its $r_{z}$ between $l_{x}$ and $l_{y}$
on line $n-1$. Thus, for every $1$ in $lc_{n-1}$ except the 
last $1$ in $lc_{n-1}$, a $0$ must immidediately proceed any $1$
in $lc_{n-1}$. Since this $0$ is implied, it can be removed from $lc_{n-1}$. 
For an example of improvement three with its line encoding for $lc_{n-1}$ please refer to Fig. 2.8.\pagebreak
\begin{figure}[!htp]
    \centering
    \begin{tikzpicture}
        \draw(0, -0.5) to (0, 4);
            \node at (0, 4.3){$n-2$};
            \draw(0, 3) to (1.5, 3);
                \node at (1.2, 3.2){$0$};
            \draw(0, 2.5) to (1.5, 2.5);
                \node at (1.2, 2.7){$0$};
            \draw(0, 1.5) to (1.5, 1.5);
                \node at (1.2, 1.7){$0$};
            \draw(0, 0.6) to (1.5, 0.6);
                 \node at (1.2, 0.8){$0$};
            \draw(0, -0.25) to (1.5, -0.25);
                \node at (1.2, -0.05){$0$};
        \draw(1.5, -0.5) to (1.5, 4);
            \node at (1.5, 4.3){$n-1$};
            \draw(1.5, 3.5) to (3, 3.5);
                \node at (1.8, 3.7){$1$};
                \node at (2.7, 3.7){$0$};
            \draw(1.5, 2) to (3, 2);
                \node at (1.8, 2.2){$1$};
                \node at (2.7, 2.2){$0$};
            \draw(1.5, 1) to (3, 1);
                \node at (1.8, 1.2){$1$};
                \node at (2.7, 1.2){$0$};
            \draw(1.5, 0.25) to (3, 0.25);
                \node at (1.8, 0.45){$\textcolor{red}{\textbf{1}}$};
                \node at (2.7, 0.45){$0$};

        \draw(3, -0.5) to (3, 4);
            \node at (3, 4.3){$n$};
    \end{tikzpicture}
    \caption{The line coding for $lc_{n-1}$ with imrpovement three is $101110\underline{0}$.
    As always, \underline{0} denotes the end of the line encoding. The red, bold $1$ represents 
    the last left end point in $lc_{n-1}$, therefore the proceeding $0$ must be 
    included in $lc_{n-1}$. For every other $1$ in $lc_{n-1}$, a $0$ is omitted following 
    said $1$.}
\end{figure}
\subsubsection{Combining All Three}
The combination of all three improvements can be done independently. 
Let $IC_{L}$ be the \emph{improved line-based encoding} for some ladder $L$.
Recall that $LC_{L}$ denotes the line-based encoding for some ladder $L$.
$LC_{L}$ for the ladder in Fig. 2.5 is $11\underline{0}010\underline{0}110\underline{0}010\underline{0}0$.
By applying imrpovement one, we get $11\underline{0}010\underline{0}110\underline{0}010\underline{0}$. 
Notice how the last $0$ from $LC_{L}$ was removed because it represented $lc_{n}$.
By applying imrpovement two to improvememt one we get $11\underline{0}00\underline{0}110\underline{0}00\underline{0}$.
Notice how the third and sixth $1$ were removed because they are implied by 
the successive $0s$. By applying improvement three to the result of improvement 
two we get 